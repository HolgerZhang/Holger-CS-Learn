#!/bin/bash
/sbin/losetup -d /dev/loop2    # 卸载占用的/dev/loop2
/sbin/losetup /dev/loop2 $1    # 第一个参数代表的文件装到/dev/loop2
/sbin/mkfs.ext2 /dev/loop2    # 使用mkfs.ext2格式化/dev/loop2
dd if=/dev/loop2 of=./tmpfs bs=1k count=2    # 头2KB内容取到临时文件系统
./changeMN $1 ./tmpfs    # 调用程序changeMN
dd if=./fs.new of=/dev/loop2    # 写回头2KB内容
/sbin/losetup -d /dev/loop2    # 卸载文件系统
rm -f ./tmpfs    # 清理临时文件系统

